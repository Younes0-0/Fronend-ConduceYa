async function R(n,t,e){const{callbackUrl:o=window.location.href,redirect:s=!0}=t??{},{prefix:c="/api/auth",...i}=t??{},a=n==="credentials",w=a||n==="email",d=`${`${c}/${a?"callback":"signin"}/${n}`}?${new URLSearchParams(e)}`,u=await fetch(`${c}/csrf`),{csrfToken:f}=await u.json(),l=await fetch(d,{method:"post",headers:{"Content-Type":"application/x-www-form-urlencoded","X-Auth-Return-Redirect":"1"},body:new URLSearchParams({...i,csrfToken:f,callbackUrl:o})}),r=await l.clone().json(),h=new URL(r.url).searchParams.get("error");if(s||!w||!h){window.location.href=r.url??o,r.url.includes("#")&&window.location.reload();return}return l}async function g(n){const{callbackUrl:t=window.location.href,prefix:e="/api/auth"}=n??{},o=await fetch(`${e}/csrf`),{csrfToken:s}=await o.json(),a=(await(await fetch(`${e}/signout`,{method:"post",headers:{"Content-Type":"application/x-www-form-urlencoded","X-Auth-Return-Redirect":"1"},body:new URLSearchParams({csrfToken:s,callbackUrl:t})})).json()).url??t;window.location.href=a,a.includes("#")&&window.location.reload()}export{g as a,R as s};
